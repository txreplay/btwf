<div class="container">
  <section class="choice" *ngIf="!action">
    <button mat-raised-button color="primary" (click)="setAction('create')">Créer une partie</button>
    <button mat-raised-button color="warn" (click)="setAction('join')">Rejoindre une partie</button>
  </section>

  <section class="cancel" *ngIf="action == 'create' || action == 'join'">
    <button mat-raised-button color="secondary" (click)="reset()">Retour</button>
  </section>

  <section class="createRoom" *ngIf="action == 'create' && !room.$room">
    <form [formGroup]="formCreateRoom" (ngSubmit)="onSubmitCreateRoom()">
      <mat-label>Votre pseudo: </mat-label>
      <input matInput type="text" [formControl]="formCreateRoom.controls['username']">

      <div class="form-group">
        <button mat-raised-button color="primary" [disabled]="!formCreateRoom.valid" type="submit">Créer</button>
      </div>
    </form>
  </section>

  <section class="currRoom" *ngIf="room.$room">
    <div *ngFor="let currRoom of room.$room | async">
      <h3>Salon : {{ currRoom.name }}</h3>
      <p>Joueurs connectés :</p>
      <ul>
        <li *ngFor="let player of currRoom.players">
          <span>{{ player|username:'name' }}</span>
          <mat-icon class="vas ml5" *ngIf="player == currRoom.admin" matTooltip="Administrateur du salon">star</mat-icon>
        </li>
      </ul>
    </div>

    <div *ngIf="action == 'create'">
      Start
    </div>

    <div *ngIf="action == 'join'">
      <p>En attente de joueurs...</p>
    </div>

    <!--TODO: If admin start the game-->
    <!--TODO: Else waiting message -->
  </section>

  <section class="joinRoom" *ngIf="action == 'join'">
    <!-- GET ROOM -->
    <form [formGroup]="formGetRoom" (ngSubmit)="onSubmitGetRoom()" *ngIf="!room.$room">
      <mat-label>Nom du salon: </mat-label>
      <input matInput type="text" [formControl]="formGetRoom.controls['roomName']">

      <div class="form-group">
        <button mat-raised-button color="primary" [disabled]="!formGetRoom.valid" type="submit">Rejoindre</button>
      </div>
    </form>

    <!-- JOIN ROOM -->
    <div *ngIf="room.$room && !auth.user">
      <form [formGroup]="formJoinRoom" (ngSubmit)="onSubmitJoinRoom()">
        <mat-label>Votre pseudo: </mat-label>
        <input matInput type="text" [formControl]="formJoinRoom.controls['username']">

        <div class="form-group">
          <button mat-raised-button color="primary" [disabled]="!formJoinRoom.valid" type="submit">Rejoindre</button>
        </div>
      </form>
    </div>

  </section>
</div>
